<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JavaScriptâ€”å¼‚æ­¥ç¼–ç¨‹ | xcc</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/logo/profile2.png">
    <meta name="description" content="JavaScriptçš„ä¸€ä¸ªæ ¸å¿ƒç‰¹æ€§æ˜¯å•ç¨‹æ‰§è¡Œ.">
    
    <link rel="preload" href="/assets/css/0.styles.fe33cd63.css" as="style"><link rel="preload" href="/assets/js/app.fb86adb2.js" as="script"><link rel="preload" href="/assets/js/6.b8e708a3.js" as="script"><link rel="preload" href="/assets/js/3.3f44ea24.js" as="script"><link rel="preload" href="/assets/js/30.66ff25e6.js" as="script"><link rel="prefetch" href="/assets/js/10.2a29879b.js"><link rel="prefetch" href="/assets/js/11.465376b6.js"><link rel="prefetch" href="/assets/js/12.0a69a4e6.js"><link rel="prefetch" href="/assets/js/13.a6564729.js"><link rel="prefetch" href="/assets/js/14.128da524.js"><link rel="prefetch" href="/assets/js/15.138998cc.js"><link rel="prefetch" href="/assets/js/16.00fd41f6.js"><link rel="prefetch" href="/assets/js/17.c047d32d.js"><link rel="prefetch" href="/assets/js/18.cdf25a70.js"><link rel="prefetch" href="/assets/js/19.861e4eac.js"><link rel="prefetch" href="/assets/js/20.0ea1d8c8.js"><link rel="prefetch" href="/assets/js/21.c6418001.js"><link rel="prefetch" href="/assets/js/22.3749550e.js"><link rel="prefetch" href="/assets/js/23.3d2bceb7.js"><link rel="prefetch" href="/assets/js/24.7831fe2d.js"><link rel="prefetch" href="/assets/js/25.fc6e1433.js"><link rel="prefetch" href="/assets/js/26.924d4716.js"><link rel="prefetch" href="/assets/js/27.33395b26.js"><link rel="prefetch" href="/assets/js/28.862644b3.js"><link rel="prefetch" href="/assets/js/29.38f29109.js"><link rel="prefetch" href="/assets/js/31.cd584b14.js"><link rel="prefetch" href="/assets/js/32.cb0b49c1.js"><link rel="prefetch" href="/assets/js/33.69bc2273.js"><link rel="prefetch" href="/assets/js/34.09f56711.js"><link rel="prefetch" href="/assets/js/35.369fe440.js"><link rel="prefetch" href="/assets/js/36.00abea01.js"><link rel="prefetch" href="/assets/js/37.e7c8ccab.js"><link rel="prefetch" href="/assets/js/38.c12daea6.js"><link rel="prefetch" href="/assets/js/39.052fb47e.js"><link rel="prefetch" href="/assets/js/4.84b14fb6.js"><link rel="prefetch" href="/assets/js/40.2cdd7367.js"><link rel="prefetch" href="/assets/js/41.a1ab30d9.js"><link rel="prefetch" href="/assets/js/42.ce2092a6.js"><link rel="prefetch" href="/assets/js/43.aa1c7a93.js"><link rel="prefetch" href="/assets/js/44.902ecfa7.js"><link rel="prefetch" href="/assets/js/45.ff38a00e.js"><link rel="prefetch" href="/assets/js/5.8613c109.js"><link rel="prefetch" href="/assets/js/7.e3359995.js"><link rel="prefetch" href="/assets/js/8.a97dd115.js"><link rel="prefetch" href="/assets/js/9.27a33244.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.d9e995a1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fe33cd63.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">xcc </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">Home</a></li><li class="nav-item"><a href="/tag/" class="nav-link">Tags</a></li><li class="nav-item"><a href="https://rebel-writer-12b.notion.site/Engineering-Wiki-6f04c16f81ed4fbd8f6d599237c98dfe" target="_blank" rel="noopener noreferrer" class="nav-link external">Notions</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">xcc </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">Home</a></li><li class="mobile-nav-item"><a href="/tag/" class="nav-link">Tags</a></li><li class="mobile-nav-item"><a href="https://rebel-writer-12b.notion.site/Engineering-Wiki-6f04c16f81ed4fbd8f6d599237c98dfe" target="_blank" rel="noopener noreferrer" class="nav-link external">Notions</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        JavaScriptâ€”å¼‚æ­¥ç¼–ç¨‹
      </h1> <div class="post-meta"><div itemprop="publisher author" itemtype="http://schema.org/Person" itemscope="itemscope" class="post-meta-author"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-navigation"><polygon points="3 11 22 2 13 21 11 13 3 11"></polygon></svg> <span itemprop="name">xucongcong</span> <!----></div> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2022-01-21T00:00:00.000Z">
      2022-01-21
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-532d3a9c><a href="/tag/JavaScript" data-v-532d3a9c><span data-v-532d3a9c>JavaScript</span></a></li><li class="post-tag" data-v-532d3a9c><a href="/tag/Node" data-v-532d3a9c><span data-v-532d3a9c>Node</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><p>JavaScriptçš„ä¸€ä¸ªæ ¸å¿ƒç‰¹æ€§æ˜¯å•çº¿ç¨‹æ‰§è¡Œï¼Œè¿™é‡Œçš„å•çº¿ç¨‹æ˜¯æŒ‡ä»£ç çš„æ‰§è¡Œæ˜¯å•çº¿ç¨‹çš„ï¼ˆå®¿ä¸»ç¯å¢ƒçš„APIå¯ä»¥å¤šçº¿ç¨‹ï¼‰ï¼Œå…¶æœ€åˆçš„ç›®çš„æ˜¯ä¸ºäº†é¿å…å¤šçº¿ç¨‹çš„DOMæ“ä½œå¯èƒ½å¸¦æ¥çš„é”™ä¹±ã€‚ä¼˜ç‚¹æ˜¯æ›´å®‰å…¨ç®€å•ï¼Œç¼ºç‚¹æ˜¯å½“é‡åˆ°ä¸€ä¸ªè€—æ—¶ä»»åŠ¡æ—¶ï¼Œåé¢çš„ä»»åŠ¡ä¼šè¢«é˜»å¡ï¼Œä»è€Œæ‹–å»¶æ•´ä¸ªç¨‹åºçš„æ‰§è¡Œã€‚</p> <p>ä¸ºäº†è§£å†³è€—æ—¶ä»»åŠ¡é˜»å¡çº¿ç¨‹çš„é—®é¢˜ï¼ŒJavaScriptå°†ä»»åŠ¡çš„æ‰§è¡Œæ¨¡å¼åˆ†ä¸ºäº†åŒæ­¥æ¨¡å¼å’Œå¼‚æ­¥æ¨¡å¼ï¼Œè¿è¡Œç¯å¢ƒä¹Ÿæä¾›äº†ä»¥åŒæ­¥æˆ–è€…å¼‚æ­¥æ¨¡å¼è¿è¡Œçš„APIã€‚</p> <ul><li><p><strong>åŒæ­¥æ¨¡å¼</strong>: ä»»åŠ¡æ’é˜Ÿæ‰§è¡Œï¼Œæ‰§è¡Œè¿‡ç¨‹å®¹æ˜“ç†è§£ã€‚</p></li> <li><p><strong>å¼‚æ­¥æ¨¡å¼</strong>: å¯¹äºè€—æ—¶æ“ä½œï¼Œå¼€å¯è¿‡åå°±ç«‹å³å¾€åæ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œå¼‚æ­¥åç»­çš„é€»è¾‘ä¸€èˆ¬é€šè¿‡å›è°ƒå‡½æ•°çš„æ–¹å¼å®šä¹‰ï¼Œåœ¨è€—æ—¶ä»»åŠ¡æ‰§è¡Œè¿‡åå°±ä¼šè‡ªåŠ¨æ‰§è¡Œä¼ å…¥çš„å›è°ƒå‡½æ•°ã€‚</p></li></ul> <center><img src="/2022-1/promise0.png" style="zoom:50%;"></center> <p>JavaScriptå¼•æ“ä¼šå…ˆæ‰§è¡Œå®Œè°ƒç”¨æ ˆä¸­çš„ä»»åŠ¡ï¼Œç„¶åé€šè¿‡äº‹ä»¶å¾ªç¯ä»â€œæ¶ˆæ¯é˜Ÿåˆ—â€ä¸­å†å–ä¸€ä¸ªå‡ºæ¥æ‰§è¡Œï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥éšæ—¶å†å¾€æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ·»åŠ ä»»åŠ¡ã€‚ä¹Ÿæ­£æ˜¯å› ä¸ºå¤§é‡çš„å¼‚æ­¥æ¨¡å¼çš„APIå¯¼è‡´ä»£ç ä¸€äº›å¤æ‚çš„å¼‚æ­¥é€»è¾‘ä¸æ˜“é˜…è¯»ã€‚</p> <br> <h2 id="_1-å›è°ƒå‡½æ•°"><a href="#_1-å›è°ƒå‡½æ•°" class="header-anchor">#</a> 1. å›è°ƒå‡½æ•°</h2> <p>å›è°ƒå‡½æ•°æ˜¯æ‰€æœ‰å¼‚æ­¥ç¼–ç¨‹æ–¹æ¡ˆçš„æ ¹åŸºï¼Œå›è°ƒå‡½æ•°ç”±è°ƒç”¨è€…å®šä¹‰ï¼Œäº¤ç»™æ‰§è¡Œè€…æ‰§è¡Œï¼Œå…·ä½“ç”¨æ³•å°±æ˜¯æŠŠå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ç½¢äº†ã€‚</p> <p>é™¤äº†ä¼ é€’å›è°ƒå‡½æ•°å‚æ•°ä»¥å¤–ï¼Œè¿˜æœ‰å‡ ç§å¸¸è§çš„å®ç°å¼‚æ­¥çš„æ–¹å¼å¦‚äº‹ä»¶æœºåˆ¶ã€å‘å¸ƒè®¢é˜…ï¼Œå¯ä»¥ç†è§£ä¸ºå›è°ƒå‡½æ•°çš„å˜ä½“ã€‚</p> <p>å½“ä½¿ç”¨ä¼ ç»Ÿå›è°ƒæ–¹å¼å»å®Œæˆå¤æ‚çš„å¼‚æ­¥æµç¨‹æ—¶ï¼Œä¼šæ— æ³•é¿å…å¤§é‡çš„å›è°ƒå‡½æ•°åµŒå¥—ï¼Œé€ æˆå›è°ƒåœ°ç‹±é—®é¢˜</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.æ‰§è¡Œä»»åŠ¡1 -&gt; ä¸‰ç§’åæ‰§è¡Œä»»åŠ¡2'</span><span class="token punctuation">)</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'2.æ‰§è¡Œä»»åŠ¡2 -&gt; 2ç§’åæ‰§è¡Œä»»åŠ¡1'</span><span class="token punctuation">)</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'3.æ‰§è¡Œä»»åŠ¡3 -&gt; 1ç§’åæ‰§è¡Œå®Œæ¯•'</span><span class="token punctuation">)</span>
      <span class="token comment">// å›è°ƒåœ°ç‹±...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span>
</code></pre></div><br> <h2 id="_2-promise"><a href="#_2-promise" class="header-anchor">#</a> 2. Promise</h2> <p><strong>ä¸ºäº†é¿å…å›è°ƒåœ°ç‹±é—®é¢˜</strong>ï¼ŒCommonJSç¤¾åŒºæå‡ºäº†Promiseè§„èŒƒï¼Œå¹¶åœ¨ES2015ä¸­è¢«æ ‡å‡†åŒ–ã€‚Promiseå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥è¡¨ç¤ºä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡æ‰§è¡Œè¿‡åç©¶ç«Ÿæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œæ— è®ºæˆåŠŸæˆ–å¤±è´¥åªéœ€è¦æ‰§è¡Œç›¸åº”çš„å›è°ƒå‡½æ•°å³å¯ã€‚</p> <center><img src="/2022-1/promise1.png" style="zoom:50%;"></center> <h3 id="_2-1-promise-çš„åŸºæœ¬ç”¨æ³•"><a href="#_2-1-promise-çš„åŸºæœ¬ç”¨æ³•" class="header-anchor">#</a> 2.1 Promise çš„åŸºæœ¬ç”¨æ³•</h3> <ol><li>æ„å»ºPromiseå®ä¾‹æ—¶ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°çš„å‚æ•°ä¸ºä¸¤ä¸ªå¤„ç†å‡½æ•°ï¼Œåœ¨Promiseé‡Œç¼–å†™æ‰¿è¯ºçš„é€»è¾‘ï¼Œå³ä»€ä¹ˆæƒ…å†µä¸‹æˆåŠŸï¼Œä»€ä¹ˆæƒ…å†µä¸‹å¤±è´¥ï¼Œå¹¶åœ¨æˆåŠŸæˆ–å¤±è´¥æ—¶æ”¹å˜çŠ¶æ€ï¼Œæ‰§è¡Œæå‰æ³¨å†Œçš„å¤„ç†å‡½æ•°</li> <li>ä½¿ç”¨thenæ–¹æ³•åˆ†åˆ«æ³¨å†Œpromiseå®ä¾‹çš„onFulfilledonå’ŒonRejectedå›è°ƒå‡½æ•°</li> <li>æ³¨æ„æ³¨å†Œçš„å‡½æ•°ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯ç­‰å¾…åŒæ­¥ä»£ç æ‰§è¡Œå®Œæ‰ä¼šæ‰§è¡Œï¼ˆå¦‚ä¸‹ä¾‹ï¼‰</li></ol> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">2</span>

<span class="token keyword">const</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">,</span> rej</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">&gt;</span> b<span class="token punctuation">)</span>
    <span class="token function">res</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">)</span> <span class="token comment">// æˆåŠŸæ—¶è°ƒç”¨reså‡½æ•°</span>
  <span class="token keyword">else</span>
    <span class="token function">rej</span><span class="token punctuation">(</span><span class="token string">'fail'</span><span class="token punctuation">)</span>    <span class="token comment">// å¤±è´¥æ—¶è°ƒç”¨rejå‡½æ•°</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">sucStr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sucStr<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">failStr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>failStr<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ç¬¬ä¸€ä¸ªåŒæ­¥ä»»åŠ¡æ‰§è¡Œæ‰ä¼šæ‰§è¡Œæå‰æ³¨å†Œçš„å¼‚æ­¥å¤„ç†å‡½æ•°'</span><span class="token punctuation">)</span>
</code></pre></div><br> <h3 id="_2-2-promise-å°è£…ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡å‡½æ•°"><a href="#_2-2-promise-å°è£…ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡å‡½æ•°" class="header-anchor">#</a> 2.2 Promise å°è£…ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡å‡½æ•°</h3> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// ä½¿ç”¨promiseå°è£…ä¸€ä¸ªajaxè¯·æ±‚</span>
<span class="token keyword">function</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span>        <span class="token comment">// æŒ‡å®šè¯·æ±‚æ–¹æ³•å’Œåœ°å€</span>
    xhr<span class="token punctuation">.</span>responseType <span class="token operator">=</span> <span class="token string">'json'</span>   <span class="token comment">// æŒ‡å®šç›¸åº”ç±»å‹ä¸ºjson</span>
    xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// è¯·æ±‚å®Œæˆåæ‰§è¡Œonloadå‡½æ•°</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>response<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'/user.json'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><br> <h3 id="_2-3-promise-çš„é“¾å¼è°ƒç”¨"><a href="#_2-3-promise-çš„é“¾å¼è°ƒç”¨" class="header-anchor">#</a> 2.3 Promise çš„é“¾å¼è°ƒç”¨</h3> <p>promiseçš„æœ¬è´¨ä¹Ÿæ˜¯ä½¿ç”¨å›è°ƒå‡½æ•°ï¼Œå³é€šè¿‡thenæ–¹æ³•ä¼ é€’è¿›å»ï¼Œè€Œä¸”promiseå°†å›è°ƒåˆ†æˆäº†ä¸¤ç§å³æˆåŠŸçš„å›è°ƒå’Œå¤±è´¥çš„å›è°ƒã€‚ä½†æ˜¯å¦‚æœéœ€è¦ä¸²è”æ‰§è¡Œå¤šä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œè¿˜æ˜¯ä¼šå‡ºç°å›è°ƒåœ°ç‹±çš„é—®é¢˜ï¼Œè¿™æ—¶å€™ä½¿ç”¨promiseå°±æ²¡æœ‰ä»»ä½•æ„ä¹‰äº†ï¼Œè¿˜é¢å¤–å¢åŠ äº†å¤æ‚åº¦ã€‚</p> <p>æ‰€ä»¥åµŒå¥—ä½¿ç”¨promiseæ˜¯ä¸å¯å–çš„ï¼Œæ­£ç¡®çš„åšæ³•æ˜¯ä½¿ç”¨promiseæ–¹æ³•é“¾å¼è°ƒç”¨çš„ç‰¹ç‚¹æ¥å°½é‡ä¿è¯ä¸²è”å¼‚æ­¥ä»»åŠ¡çš„ â€œæ‰å¹³åŒ–â€ã€‚</p> <ul><li>promiseçš„thenæ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª<strong>å…¨æ–°çš„</strong>promiseå¯¹è±¡ï¼Œç”¨äºå®ç°promiseçš„é“¾å¼è°ƒç”¨</li> <li>åé¢çš„thenå°±æ˜¯åœ¨ä¸ºå‰é¢thenè¿”å›çš„promiseæ³¨å†Œå›è°ƒ</li> <li>å‰é¢thenæ–¹æ³•ä¸­è°ƒç”¨å‡½æ•°çš„è¿”å›å€¼ä¼šä½œä¸ºåé¢thenæ–¹æ³•å›è°ƒçš„å‚æ•°</li> <li>è‹¥å›è°ƒä¸­è¿”å›çš„æ˜¯ä¸€ä¸ªpromiseå¯¹è±¡ï¼Œåˆ™åé¢thenæ–¹æ³•çš„å›è°ƒä¼šç­‰å¾…ä»–çš„ç»“æŸ</li></ul> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'api/url1'</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'api/url2'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'api/url3'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'api/url4'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>å¤šæ¬¡catchçš„é“¾å¼è°ƒç”¨ï¼ˆ<em>for test</em>ï¼‰ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> p <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'fail1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

p<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ok1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ok2'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'fail2'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ok3'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ok4'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><br> <h3 id="_2-4-promise-çš„å¼‚å¸¸å¤„ç†"><a href="#_2-4-promise-çš„å¼‚å¸¸å¤„ç†" class="header-anchor">#</a> 2.4 Promise çš„å¼‚å¸¸å¤„ç†</h3> <p>é™¤äº†promiseçš„æ‰§è¡Œé€»è¾‘æ‰§è¡Œäº†rejectå‡½æ•°ï¼Œåœ¨promiseåœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯æˆ–è€…ä¸»åŠ¨æŠ›å‡ºå¼‚å¸¸ä¹Ÿä¼šæ‰§è¡Œrejectå‡½æ•°ï¼Œæ‰€ä»¥thenæ–¹æ³•ä¸­æ³¨å†Œçš„onrejectedå‡½æ•°å°±æ˜¯ä¸ºpromiseçš„å¼‚å¸¸åšå¤„ç†ï¼Œå³promiseå¤±è´¥æˆ–è€…å‡ºç°å¼‚å¸¸éƒ½ä¼šè¢«æ‰§è¡Œã€‚å…¶å®onrejectedå‡½æ•°çš„æ³¨å†Œè¿˜æœ‰ä¸€ä¸ªæ›´å¸¸è§çš„ç”¨æ³•ï¼Œå³ä½¿ç”¨promiseå®ä¾‹çš„catchæ–¹æ³•æ³¨å†Œonrejectedå›è°ƒ</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'/user.json'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">onFulfilled</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">onRejcted</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// ç­‰åŒäº</span>
<span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'/user.json'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">onFulfilled</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">onRejcted</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>ç”¨catchæ–¹æ³•æ›´å¸¸è§ï¼Œå› ä¸ºæ›´é€‚åˆé“¾å¼è°ƒç”¨ã€‚é”™è¯¯ä¼šéšç€promiseé“¾æ¡ä¼ é€’ï¼Œæ‰€ä»¥æœ€åä½¿ç”¨c<strong>atchæ–¹æ³•æ›´åƒæ˜¯ç»™æ•´ä¸ªpromiseé“¾æ¡æ³¨å†Œçš„å¤±è´¥å›è°ƒ</strong></p> <br> <h3 id="_2-5-promise-çš„é™æ€æ–¹æ³•"><a href="#_2-5-promise-çš„é™æ€æ–¹æ³•" class="header-anchor">#</a> 2.5 Promise çš„é™æ€æ–¹æ³•</h3> <div class="language-jsx extra-class"><pre class="language-jsx"><code>Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">)</span>  <span class="token comment">// ç›´æ¥è¿”å›ä¸€ä¸ªæˆåŠŸçš„Promiseå¯¹è±¡</span>
Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>promise<span class="token punctuation">)</span>    <span class="token comment">// å¦‚æœæ¥æ”¶åˆ°ä¸€ä¸ªpromiseå¯¹è±¡åˆ™åŸæ ·è¿”å›</span>

Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'rejected'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// å¿«é€Ÿå¾—åˆ°ä¸€ä¸ªä¸€å®šæ˜¯å¤±è´¥çš„promiseå¯¹è±¡</span>
	<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><br> <h3 id="_2-6-promise-å¹¶è¡Œæ‰§è¡Œ"><a href="#_2-6-promise-å¹¶è¡Œæ‰§è¡Œ" class="header-anchor">#</a> 2.6 Promise å¹¶è¡Œæ‰§è¡Œ</h3> <p>å‰é¢éƒ½æ˜¯å¤šä¸ªpromiseä¸²è”æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ï¼Œè€Œå½“å¤šä¸ªä»»åŠ¡å½¼æ­¤æ²¡æœ‰ä¾èµ–æ—¶å¯ä»¥å¹¶è¡Œæ‰§è¡Œæ¥æé«˜æ‰§è¡Œé€Ÿåº¦ï¼ŒPromise.allæ–¹æ³•å¯ä»¥å°†å¤šä¸ªpromiseåˆå¹¶ä¸ºä¸€ä¸ªpromiseç»Ÿä¸€ç®¡ç†ã€‚Promise.all()æ¥æ”¶ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªpromiseå¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªå…¨æ–°çš„promiseå¯¹è±¡ï¼Œå½“å…¶å†…éƒ¨æ‰€æœ‰çš„promiseéƒ½å®Œæˆåï¼Œè¿™ä¸ªæ–°çš„promiseå¯¹è±¡æ‰ä¼šå®Œæˆï¼Œä¸”å…¶æ‹¿åˆ°çš„ç»“æœä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„åŒ…å«æ¯ä¸ªå¼‚æ­¥ä»»åŠ¡æ‰§è¡Œçš„ç»“æœã€‚å…¶ä¸­ä»»ä½•ä¸€ä¸ªpromiseå¤±è´¥ï¼Œè¿™ä¸ªæ–°çš„promiseä¹Ÿå°±å¤±è´¥äº†ã€‚</p> <p>ç¤ºä¾‹ï¼šå…ˆæ‹¿åˆ°è¦è®¿é—®çš„urlåˆ—è¡¨ï¼Œå†å¹¶è¡Œè®¿é—®</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'/urls.json'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> urls <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">const</span> tasks <span class="token operator">=</span> urls<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">map</span> <span class="token operator">=&gt;</span> <span class="token function">ajax</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>tasks<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">values</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Promise.race()ä¹Ÿå¯ä»¥å°†å¤šä¸ªpromiseåˆå¹¶ä¸ºä¸€ä¸ªpromiseå¯¹è±¡ï¼Œä½†Promise.all()ç­‰å¾…æ‰€æœ‰ä»»åŠ¡ç»“æŸæ‰ä¼šç»“æŸï¼Œè€ŒPromise.race()åªä¼šç­‰å¾…ç¬¬ä¸€ä¸ªå…ˆç»“æŸçš„ä»»åŠ¡ã€‚</p> <p>ç¤ºä¾‹ï¼šä¸€ä¸ªè¯·æ±‚promise+ä¸€ä¸ªå®šæ—¶promiseç”¨äºå¤„ç†è¯·æ±‚è¶…æ—¶</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> request <span class="token operator">=</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'/urls.json'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> timeout <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'timeout'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  request<span class="token punctuation">,</span>
  timeout
<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><br> <h3 id="_2-7-promise-çš„æ‰§è¡Œæ—¶åº-å®ä»»åŠ¡-å¾®ä»»åŠ¡"><a href="#_2-7-promise-çš„æ‰§è¡Œæ—¶åº-å®ä»»åŠ¡-å¾®ä»»åŠ¡" class="header-anchor">#</a> 2.7 Promise çš„æ‰§è¡Œæ—¶åºï¼ˆå®ä»»åŠ¡&amp;å¾®ä»»åŠ¡ï¼‰</h3> <p>å³ä½¿Promiseæ²¡æœ‰ä»»ä½•çš„å¼‚æ­¥æ“ä½œï¼Œå®ƒçš„å›è°ƒå‡½æ•°ä»ç„¶ä¸ä¼šç«‹å³æ‰§è¡Œè€Œæ˜¯è¿›å…¥å›è°ƒé˜Ÿåˆ—ä¸­æ’é˜Ÿï¼Œå³ç­‰å¾…æ‰€æœ‰åŒæ­¥ä»£ç æ‰§è¡Œå®Œåæ‰ä¼šæ‰§è¡Œã€‚</p> <p>ä½†åœ¨å›è°ƒé˜Ÿåˆ—ä¸­æ’é˜Ÿç­‰å¾…çš„ä»»åŠ¡å¹¶ä¸æ˜¯å¹³ç­‰çš„ã€‚å›è°ƒé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ç§°ä¸ºå®ä»»åŠ¡ï¼Œå®ä»»åŠ¡çš„æ‰§è¡Œè¿‡ç¨‹ä¸­å¯ä»¥ä¸´æ—¶åŠ ä¸Šä¸€äº›é¢å¤–éœ€æ±‚ï¼Œè¿™äº›ä¸´æ—¶éœ€æ±‚å¯ä»¥ä½œä¸ºæ–°çš„å®ä»»åŠ¡è¿›åˆ°é˜Ÿåˆ—æ’é˜Ÿï¼ˆå¦‚ä¸‹setTimeoutå›è°ƒï¼‰ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå½“å‰ä»»åŠ¡çš„å¾®ä»»åŠ¡ï¼Œç›´æ¥åœ¨æœ¬è½®è°ƒç”¨çš„æœ«å°¾ç«‹å³æ‰§è¡Œï¼ˆå¦‚ä¸‹Promiseå›è°ƒï¼‰ï¼Œå¾®ä»»åŠ¡çš„æ¦‚å¿µæ˜¯åæ¥æ‰æåˆ°JSä¸­çš„ï¼Œç›®çš„æ˜¯ä¸ºäº†æé«˜æ•´ä½“å“åº”èƒ½åŠ›ã€‚ç›®å‰ç»å¤§å¤šæ•°å¼‚æ­¥è°ƒç”¨çš„APIéƒ½æ˜¯ä½œä¸ºå®ä»»åŠ¡æ‰§è¡Œï¼Œè€Œä½œä¸ºå¾®ä»»åŠ¡çš„æœ‰Promise &amp; MutationObserver &amp; Nodeä¸­çš„process.nextTick</p> <aside>
ğŸ’¡ åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­æœ‰ä¸¤ä¸ªä»»åŠ¡é˜Ÿåˆ—ï¼šå®ä»»åŠ¡å’Œå¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå¾®ä»»åŠ¡é˜Ÿåˆ—ä¼˜å…ˆçº§æ›´é«˜ï¼Œæ‰€ä»¥åŒæ­¥ä»£ç æ‰§è¡Œå®Œæˆ–æ¯æ¬¡ä¸€ä¸ªå®ä»»åŠ¡æ‰§è¡Œå®Œåï¼Œéƒ½ä¼šä¼˜å…ˆæ¸…ç©ºå¾®ä»»åŠ¡é˜Ÿåˆ—ã€‚
<p>åœ¨Nodeä¸­ï¼Œä»»åŠ¡é˜Ÿåˆ—çš„ä¼˜å…ˆçº§åˆ’åˆ†æ¯”æµè§ˆå™¨æ›´åŠ ç»†åŒ–ã€‚</p></aside> <div class="language-jsx extra-class"><pre class="language-jsx"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">)</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'settimeout'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise2'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise3'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">)</span>

<span class="token comment">// --------------------------</span>
start
end
promise1
promise2
promise3
settimeout
</code></pre></div><br> <h2 id="_3-generatorå¼‚æ­¥æ–¹æ¡ˆ"><a href="#_3-generatorå¼‚æ­¥æ–¹æ¡ˆ" class="header-anchor">#</a> 3. Generatorå¼‚æ­¥æ–¹æ¡ˆ</h2> <p>ç›¸æ¯”äºä¼ ç»Ÿå¼‚æ­¥è°ƒç”¨çš„æ–¹å¼ï¼Œç”¨Promiseå¤„ç†å¼‚æ­¥è°ƒç”¨æœ€å¤§çš„ä¼˜åŠ¿å°±æ˜¯å¯ä»¥é€šè¿‡é“¾å¼è°ƒç”¨è§£å†³å›è°ƒåµŒå¥—çš„é—®é¢˜ï¼Œå¯ä»¥å®ç°å¼‚æ­¥ä»»åŠ¡çš„ä¸²è”æ‰§è¡Œï¼Œä½†è¿™æ ·ä¾ç„¶æœ‰å¤§é‡çš„å›è°ƒå‡½æ•°ï¼ˆå°½ç®¡æ²¡åµŒå¥—ï¼‰ï¼Œä¾ç„¶æ²¡æœ‰è¾¾åˆ°ä¼ ç»ŸåŒæ­¥ä»£ç çš„å¯è¯»æ€§ã€‚</p> <p>ES2015æä¾›äº†Generatorï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// ç”Ÿæˆå™¨å‡½æ•°çš„è¯­æ³•å°±æ˜¯æ™®é€šå‡½æ•°åŠ ä¸ª*</span>
<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token string">'foo'</span>  <span class="token comment">// é‡åˆ°yieldä¼šæš‚åœç”Ÿæˆå™¨çš„æ‰§è¡Œ,å¹¶æŠŠåé¢çš„å€¼è¿”å›å‡ºå»</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// è°ƒç”¨ç”Ÿæˆå™¨å‡½æ•°ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡</span>
<span class="token keyword">const</span> generator <span class="token operator">=</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 1.æ‰‹åŠ¨è°ƒç”¨ç”Ÿæˆå™¨å¯¹è±¡çš„nextæ–¹æ³•ï¼Œç”Ÿæˆå™¨å‡½æ•°çš„å‡½æ•°ä½“æ‰ä¼šå¼€å§‹æ‰§è¡Œ</span>
<span class="token comment">// 2.resultå¯ä»¥æ¥æ”¶yieldè¿”å›çš„å€¼</span>
<span class="token comment">// 3.å¯ä»¥ä¼ é€’å‚æ•°åˆ°å‡½æ•°ä¸­yieldçš„ä½ç½®</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> generator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>

generator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span>

<span class="token comment">// throwæ–¹æ³•ä¹Ÿå¯ä»¥è®©ç”Ÿæˆå™¨ç»§ç»­æ‰§è¡Œï¼Œä¸è¿‡ä¼šå‘ç”Ÿæˆå™¨ä¸­æŠ›å‡ºå¼‚å¸¸</span>
generator<span class="token punctuation">.</span><span class="token function">throw</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Generator error'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>å¯ä»¥åˆ©ç”¨yieldæš‚åœç”Ÿæˆå™¨å‡½æ•°æ‰§è¡Œçš„ç‰¹ç‚¹ï¼Œå®ç°æ›´ä¼˜çš„å¼‚æ­¥ç¼–ç¨‹ä½“éªŒï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'/api/users.json'</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span>

  <span class="token keyword">const</span> posts <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'/api/posts.json'</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>posts<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> g <span class="token operator">=</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// result.valueæ‹¿åˆ°è¿”å›çš„promiseå¯¹è±¡</span>
result<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> result2 <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>result2<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token keyword">return</span>
  result2<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result3 <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result3<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token keyword">return</span>
    result3<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>ä½¿ç”¨é€’å½’ä¼˜åŒ–ä¸Šè¿°ä»£ç ï¼Œå®ç°æ›´é€šç”¨çš„ç”Ÿæˆå™¨å‡½æ•°çš„æ‰§è¡Œå™¨ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token operator">*</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'/api/users.json'</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span>
    <span class="token keyword">const</span> posts <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'/api/posts.json'</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>posts<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">handleResult</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token keyword">return</span>
  result<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">handleResult</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span><span class="token function">throw</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> g <span class="token operator">=</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">handleResult</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">/*---------------------------------------------*/</span>

<span class="token comment">// è¿›ä¸€æ­¥å°è£…</span>
<span class="token keyword">function</span> <span class="token function">co</span><span class="token punctuation">(</span><span class="token parameter">generator</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> g <span class="token operator">=</span> <span class="token function">generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  
  <span class="token keyword">function</span> <span class="token function">handleResult</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token keyword">return</span>
    result<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">handleResult</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      g<span class="token punctuation">.</span><span class="token function">throw</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">handleResult</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">co</span><span class="token punctuation">(</span>main<span class="token punctuation">)</span>
</code></pre></div><p>ğŸ’¡ è¿™ç§coçš„å®ç°åœ¨2015å¹´å‰æµè¡Œï¼Œåæ¥å‡ºç°Async/Awaitåï¼Œå°±ä¸å¤ªç”¨äº†</p> <br> <h2 id="_4-async-awaitè¯­æ³•ç³–"><a href="#_4-async-awaitè¯­æ³•ç³–" class="header-anchor">#</a> 4. Async/Awaitè¯­æ³•ç³–</h2> <p>æœ‰äº†Generatorï¼ŒJSçš„å¼‚æ­¥ç¼–ç¨‹å°±æœ‰ç±»ä¼¼åŒæ­¥çš„ç¼–ç¨‹ä½“éªŒäº†ï¼Œä½†ç”¨Generatoræ–¹æ¡ˆè¿˜éœ€è¦è‡ªå·±ç¼–å†™ä¸€ä¸ªæ‰§è¡Œå™¨å‡½æ•°ï¼ˆcoï¼‰ï¼Œæ¯”è¾ƒéº»çƒ¦ã€‚è€Œåœ¨ES2017ä¸­æ–°å¢äº†Asyncå‡½æ•°åŒæ ·æä¾›äº†æ‰å¹³åŒ–çš„å¼‚æ­¥ç¼–ç¨‹ä½“éªŒï¼Œä½¿ç”¨èµ·æ¥æ›´æ–¹ä¾¿ã€‚</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'/api/users.json'</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span>
    <span class="token keyword">const</span> posts <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'/api/posts.json'</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>posts<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>æ­¤å¤–ï¼Œasyncè¿˜ä¼šè¿”å›ä¸€ä¸ªpromiseå¯¹è±¡ï¼Œæ›´åŠ åˆ©äºå¯¹æ•´ä½“ä»£ç è¿›è¡Œæ§åˆ¶ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> promise <span class="token operator">=</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'all completed'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>ğŸ’¡ ç›®å‰awaitå…³é”®å­—åªèƒ½åœ¨asyncå‡½æ•°å†…éƒ¨ä½¿ç”¨ï¼Œåœ¨æ–°æ ‡å‡†ä¸­å¯èƒ½åœ¨å¤–éƒ¨ä½¿ç”¨</p> <br> <h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="header-anchor">#</a> å‚è€ƒæ–‡æ¡£</h2></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#_1-å›è°ƒå‡½æ•°" title="1. å›è°ƒå‡½æ•°">1. å›è°ƒå‡½æ•°</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#_2-promise" title="2. Promise">2. Promise</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_2-1-promise-çš„åŸºæœ¬ç”¨æ³•" title="2.1 Promise çš„åŸºæœ¬ç”¨æ³•">2.1 Promise çš„åŸºæœ¬ç”¨æ³•</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_2-2-promise-å°è£…ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡å‡½æ•°" title="2.2 Promise å°è£…ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡å‡½æ•°">2.2 Promise å°è£…ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡å‡½æ•°</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_2-3-promise-çš„é“¾å¼è°ƒç”¨" title="2.3 Promise çš„é“¾å¼è°ƒç”¨">2.3 Promise çš„é“¾å¼è°ƒç”¨</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_2-4-promise-çš„å¼‚å¸¸å¤„ç†" title="2.4 Promise çš„å¼‚å¸¸å¤„ç†">2.4 Promise çš„å¼‚å¸¸å¤„ç†</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_2-5-promise-çš„é™æ€æ–¹æ³•" title="2.5 Promise çš„é™æ€æ–¹æ³•">2.5 Promise çš„é™æ€æ–¹æ³•</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_2-6-promise-å¹¶è¡Œæ‰§è¡Œ" title="2.6 Promise å¹¶è¡Œæ‰§è¡Œ">2.6 Promise å¹¶è¡Œæ‰§è¡Œ</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_2-7-promise-çš„æ‰§è¡Œæ—¶åº-å®ä»»åŠ¡-å¾®ä»»åŠ¡" title="2.7 Promise çš„æ‰§è¡Œæ—¶åºï¼ˆå®ä»»åŠ¡&amp;å¾®ä»»åŠ¡ï¼‰">2.7 Promise çš„æ‰§è¡Œæ—¶åºï¼ˆå®ä»»åŠ¡&amp;å¾®ä»»åŠ¡ï¼‰</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#_3-generatorå¼‚æ­¥æ–¹æ¡ˆ" title="3. Generatorå¼‚æ­¥æ–¹æ¡ˆ">3. Generatorå¼‚æ­¥æ–¹æ¡ˆ</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#_4-async-awaitè¯­æ³•ç³–" title="4. Async/Awaitè¯­æ³•ç³–">4. Async/Awaitè¯­æ³•ç³–</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#å‚è€ƒæ–‡æ¡£" title="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</a></div></div></div></div> <footer class="footer" data-v-8eb634d6><div class="footer-left-wrap" data-v-8eb634d6><ul class="contact" data-v-8eb634d6><li class="contact-item" data-v-8eb634d6><a href="https://github.com/awesomexu" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-8eb634d6><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-8eb634d6><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-8eb634d6></path></svg>
          
        </a></li><li class="contact-item" data-v-8eb634d6><a href="mailto:xcc_mail@163.com" class="nav-link external" data-v-8eb634d6><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail" data-v-8eb634d6><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" data-v-8eb634d6></path><polyline points="22,6 12,13 2,6" data-v-8eb634d6></polyline></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-8eb634d6><ul class="copyright" data-v-8eb634d6><li class="copyright-item" data-v-8eb634d6><a href="https://policies.google.com/privacy?hl=en-US" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-8eb634d6>Privacy Policy</a></li></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.fb86adb2.js" defer></script><script src="/assets/js/6.b8e708a3.js" defer></script><script src="/assets/js/3.3f44ea24.js" defer></script><script src="/assets/js/30.66ff25e6.js" defer></script>
  </body>
</html>
