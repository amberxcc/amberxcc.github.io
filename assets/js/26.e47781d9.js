(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{318:function(t,s,a){"use strict";a.r(s);var n=a(5),p=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("blockquote",[a("p",[t._v("Streams are Nodeâ€™s best and most misunderstood idea.\nâ€” Dominic Tarr")])]),t._v(" "),a("center",[a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/2022-1/nodestream0.png"}})]),t._v(" "),a("p",[t._v("Node streams ä»¥éš¾ä»¥ä½¿ç”¨è‘—ç§°ï¼Œç”šè‡³éš¾ä»¥ç†è§£ã€‚ä¸è¿‡æœ‰ä¸ªå¥½æ¶ˆæ¯æ˜¯ï¼Œå¤šå¹´æ¥ï¼Œå¼€å‘è€…ä»¬ä¸ºäº†è®© streams çš„ä½¿ç”¨æ›´æ–¹ä¾¿ï¼Œå¼€å‘äº†å¾ˆå¤šå·¥å…·åŒ…ã€‚ä¸è¿‡æœ¬æ–‡å°†é‡ç‚¹å…³æ³¨åŸç”Ÿ stream APIã€‚")]),t._v(" "),a("h2",{attrs:{id:"_1-æµåˆ°åº•æ˜¯å•¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-æµåˆ°åº•æ˜¯å•¥"}},[t._v("#")]),t._v(" 1. æµåˆ°åº•æ˜¯å•¥?")]),t._v(" "),a("p",[t._v("æµæ˜¯æ•°æ®çš„é›†åˆï¼Œå°±åƒæ•°ç»„æˆ–å­—ç¬¦ä¸²ä¸€æ ·ã€‚ä¸åŒä¹‹å¤„åœ¨äºæµé€šå¸¸ä¸æ˜¯ä¸€æ¬¡æ€§ä½¿ç”¨çš„ï¼Œå¹¶ä¸”å…¶æ•°æ®æ²¡å¿…è¦å…¨éƒ¨æ”¾åœ¨å†…å­˜ä¸­ã€‚è¿™ä½¿å¾—æµåœ¨å¤„ç†å¤§é‡æ•°æ®ï¼ˆæˆ–ä¸€ä¸ªæ¥è‡ªå¤–éƒ¨æºä¸”ä¸€ä¼šä¼ æ¥ä¸€å—ï¼‰æ—¶éå¸¸å¼ºå¤§ã€‚")]),t._v(" "),a("p",[t._v("ç„¶è€Œï¼Œæµä¸ä»…ä»…å¯ä»¥å¤„ç†å¤§çš„æ•°æ®ã€‚å®ƒä»¬è¿˜èµ‹äºˆäº†æˆ‘ä»¬ä»£ç ä¸­å¯ç»„åˆæ€§çš„åŠ›é‡ï¼Œå°±åƒæˆ‘ä»¬å¯ä»¥é€šè¿‡ç®¡é“å…¶ä»–è¾ƒå°çš„ Linux å‘½ä»¤æ¥ç¼–å†™å¼ºå¤§çš„ Linux å‘½ä»¤ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Node ä¸­ç”¨æµåšåŒæ ·çš„äº‹æƒ…ã€‚")]),t._v(" "),a("center",[a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/2022-1/nodestream1.png"}})]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" grep "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// A stream for the grep output")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" wc "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// A stream for the wc input")]),t._v("\n\ngrep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("Node ä¸­çš„è®¸å¤šå†…ç½®æ¨¡å—éƒ½å®ç°äº†æµæ¥å£ï¼š")]),t._v(" "),a("center",[a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/2022-1/nodestream2.png"}})]),t._v(" "),a("p",[t._v("ä¸Šé¢çš„åˆ—è¡¨ä¸­æœ‰ä¸€äº›åŸç”Ÿ Node å¯¹è±¡ï¼Œæœ‰äº›å¯¹è±¡æ˜¯å¯è¯»æˆ–å¯å†™æµï¼Œæœ‰äº›å¯¹è±¡æ—¢æ˜¯å¯è¯»æµåˆæ˜¯å¯å†™æµï¼Œä¾‹å¦‚ TCP socketsã€"),a("code",[t._v("zlib")]),t._v("å’ŒÂ "),a("code",[t._v("crypto")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("ğŸ’¡æ³¨æ„ï¼Œè™½ç„¶ HTTP respnose åœ¨å®¢æˆ·ç«¯ä¸Šæ˜¯å¯è¯»æµï¼Œä½†å®ƒåœ¨æœåŠ¡å™¨ä¸Šæ˜¯å¯å†™æµã€‚å› ä¸ºåœ¨ HTTP ä¸­ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šä»ä¸€ä¸ªå¯¹è±¡ (http.IncomingMessage) è¯»å–å¹¶å†™å…¥å¦ä¸€ä¸ªå¯¹è±¡ (http.ServerResponse)ã€‚")]),t._v(" "),a("p",[t._v("ğŸ’¡è¿˜è¦æ³¨æ„çš„æ˜¯ï¼Œå½“æ¶‰åŠåˆ°å­è¿›ç¨‹æ—¶ï¼Œstdio æµï¼ˆstdinã€stdoutã€stderrï¼‰å¦‚ä½•å…·æœ‰é€†æµç±»å‹ã€‚è¿™æä¾›äº†ä¸€ç§éå¸¸ç®€å•çš„æ–¹æ³•æ¥ä½¿ç”¨ä¸»è¿›ç¨‹ stdio æµä¸è¿™äº›å­è¿›ç¨‹ stdio æµè¿›è¡Œç®¡é“ä¼ è¾“ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_2-ä¸€ä¸ªç®€å•çš„æµçš„å®ä¾‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-ä¸€ä¸ªç®€å•çš„æµçš„å®ä¾‹"}},[t._v("#")]),t._v(" 2. ä¸€ä¸ªç®€å•çš„æµçš„å®ä¾‹")]),t._v(" "),a("p",[t._v("ç†è®ºè¯´çš„å¥½åƒå¾ˆç‰›çš„æ ·å­ï¼Œä½†é€šå¸¸ä¸æ˜¯ 100% æœ‰è¯´æœåŠ›ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼Œå±•ç¤ºåœ¨å†…å­˜æ¶ˆè€—æ–¹é¢æµå¯ä»¥åœ¨ä»£ç ä¸­äº§ç”Ÿçš„å·®å¼‚ã€‚")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªå¤§æ–‡ä»¶ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" file "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createWriteStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./big.file"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1e6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\\n"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nfile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("çœ‹åˆ°æˆ‘ç”¨ä»€ä¹ˆAPIåˆ›å»ºå¤§æ–‡ä»¶çš„äº†å—ï¼Œä¸€ä¸ªå¯å†™æµï¼")]),t._v(" "),a("p",[t._v("å¯ä»¥ä½¿ç”¨fsæ¨¡å—æä¾›çš„æµå¼æ¥å£è¯»å†™æ–‡ä»¶ï¼Œä¸Šè¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç”¨å¾ªç¯é€šè¿‡å¾€å¯å†™æµé‡Œé¢å†™äº†100ä¸‡è¡Œå­—ç¬¦ã€‚")]),t._v(" "),a("p",[t._v("è¿è¡Œä¸Šé¢çš„è„šæœ¬ä¼šç”Ÿæˆä¸€ä¸ªå¤§çº¦ "),a("strong",[t._v("400 MB")]),t._v(" çš„æ–‡ä»¶ã€‚")]),t._v(" "),a("p",[t._v("ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„web server ä¸“é—¨ç”¨æ¥æœåŠ¡äºè¿™ä¸ªæ–‡ä»¶çš„ä¼ è¾“çš„ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nserver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"request"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./big.file"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nserver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("å½“æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œå®ƒå°†ä½¿ç”¨"),a("code",[t._v("fs.readFile")]),t._v("è¿™ä¸ªå¼‚æ­¥æ–¹æ³•æä¾›è¿™ä¸ªå¤§æ–‡ä»¶ã€‚è¿™æ ·ä½¿ç”¨å¼‚æ­¥æ–¹å¼å¤„ç†IOè²Œä¼¼çœ‹èµ·æ¥æŒºåˆç†ï¼Œä¸»è¿›ç¨‹å¹¶ä¸ä¼šè¢«IOé˜»å¡ã€‚")]),t._v(" "),a("p",[t._v("å¥½å§ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å½“æˆ‘ä»¬è¿è¡ŒæœåŠ¡å™¨ã€è¿æ¥åˆ°å®ƒå¹¶åŒæ—¶ç›‘æ§å†…å­˜æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚")]),t._v(" "),a("p",[t._v("å½“æˆ‘åˆšå¯åŠ¨æœåŠ¡å™¨æ—¶ï¼Œå®ƒä»¥æ­£å¸¸çš„å†…å­˜é‡å¼€å§‹ï¼Œ8.7 MBï¼š")]),t._v(" "),a("center",[a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/2022-1/nodestream3.png"}})]),t._v(" "),a("p",[t._v("ç„¶åæˆ‘è¿æ¥åˆ°æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚æ³¨æ„å†…å­˜æ¶ˆè€—çš„å˜åŒ–ï¼šå†…å­˜æ¶ˆè€—è·ƒå‡è‡³ 434.8 MBï¼")]),t._v(" "),a("center",[a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/2022-1/nodestream4.png"}})]),t._v(" "),a("p",[t._v("è¿™ç§æ–¹å¼åŸºæœ¬ä¸Šå°†æ•´ä¸ª big.file å†…å®¹æ”¾åœ¨å†…å­˜ä¸­ï¼Œç„¶åå†å°†å…¶å†™å…¥å“åº”å¯¹è±¡ã€‚è¿™æ˜¯éå¸¸ä½æ•ˆçš„ã€‚")]),t._v(" "),a("p",[t._v("HTTPå“åº”å¯¹è±¡ä¹Ÿæ˜¯ä¸€ä¸ªå¯å†™æµï¼Œè¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªè¡¨ç¤º big.file å†…å®¹çš„å¯è¯»æµï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸¤è€…ç›¸äº’è¿æ¥å¹¶è·å¾—å‡ ä¹ç›¸åŒçš„å®ç°æ–¹å¼ï¼Œè€Œä¸ä¼šæ¶ˆè€—çº¦ 400 MB å†…å­˜ã€‚")]),t._v(" "),a("p",[t._v("Node çš„ fs æ¨¡å—å¯ä»¥ä½¿ç”¨ createReadStream æ–¹æ³•ä¸ºæˆ‘ä»¬æä¾›ä»»ä½•æ–‡ä»¶çš„å¯è¯»æµã€‚æˆ‘ä»¬å¯ä»¥å°†å…¶é€šè¿‡ç®¡é“ä¼ é€’ç»™å“åº”å¯¹è±¡ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nserver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"request"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createReadStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./big.file"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  src"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nserver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("ç°åœ¨ï¼Œå½“è¿æ¥åˆ°è¿™ä¸ªæœåŠ¡å™¨æ—¶ï¼Œç¥å¥‡çš„äº‹æƒ…å‘ç”Ÿäº†:")]),t._v(" "),a("center",[a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/2022-1/nodestream5.png"}})]),t._v(" "),a("p",[a("strong",[t._v("å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ")])]),t._v(" "),a("p",[t._v("å½“å®¢æˆ·ç«¯è¯·æ±‚è¯¥å¤§æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬ç”¨â€œæµâ€çš„å½¢å¼ä¸€å—ä¸€å—çš„ä¼ ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬æ ¹æœ¬ä¸ä¼šå°†å…¶ç¼“å†²åœ¨å†…å­˜ä¸­ã€‚å†…å­˜ä½¿ç”¨é‡åªå¢åŠ äº†çº¦ 25 MBè€Œå·²ã€‚")]),t._v(" "),a("p",[t._v("æ‚¨å¯ä»¥å°†æ­¤ç¤ºä¾‹æ¨å‘æé™ã€‚ç”¨ 500 ä¸‡è¡Œè€Œä¸æ˜¯ 100 ä¸‡è¡Œé‡æ–°ç”Ÿæˆ big.fileï¼Œè¿™å°†ä½¿æ–‡ä»¶è¶…è¿‡ 2 GBï¼Œè¿™å®é™…ä¸Šå¤§äº Node.js ä¸­çš„é»˜è®¤ç¼“å†²åŒºé™åˆ¶ã€‚")]),t._v(" "),a("p",[t._v("å¦‚æœä½ å°è¯•ä½¿ç”¨ fs.readFile æä¾›è¯¥æ–‡ä»¶ï¼Œåˆ™é»˜è®¤æƒ…å†µä¸‹æ‚¨æ ¹æœ¬æ— æ³•å®ç°ï¼ˆé™¤éæ‰‹åŠ¨æ”¹å˜ç¼“å†²åŒºå¤§å°é™åˆ¶ï¼‰ã€‚ä½†æ˜¯ä½¿ç”¨ fs.createReadStream å°† 2 GB æ•°æ®æµå¼ä¼ è¾“åˆ°è¯·æ±‚è€…å®Œå…¨æ²¡æœ‰é—®é¢˜ï¼Œè€Œä¸”æœ€é‡è¦çš„æ˜¯ï¼Œè¿›ç¨‹å†…å­˜æ¶ˆè€—ä¸ä¼šæœ‰å¤ªå¤§å˜åŒ–ã€‚")]),t._v(" "),a("p",[a("strong",[t._v("ç°åœ¨å‡†å¤‡å¥½å­¦ä¹ æµäº†å—ï¼Ÿ")])]),t._v(" "),a("h2",{attrs:{id:"_3-æµçš„åˆ†ç±»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-æµçš„åˆ†ç±»"}},[t._v("#")]),t._v(" 3. æµçš„åˆ†ç±»")]),t._v(" "),a("p",[t._v("Node ä¸­æœ‰å››ç§åŸºæœ¬çš„æµç±»å‹ï¼š"),a("strong",[t._v("Readable")]),t._v("ã€"),a("strong",[t._v("Writable")]),t._v("ã€"),a("strong",[t._v("Duplex")]),t._v(" å’Œ "),a("strong",[t._v("Transform")]),t._v(" æµã€‚")]),t._v(" "),a("ul",[a("li",[t._v("å¯è¯»æµæ˜¯å¯¹å¯ä»¥ä»ä¸­è·å–æ•°æ®çš„æºçš„æŠ½è±¡ã€‚ fs.createReadStream æ–¹æ³•å°±æ˜¯ä¸€ä¸ªä¾‹å­ã€‚")]),t._v(" "),a("li",[t._v("å¯å†™æµæ˜¯å¯¹å¯ä»¥å†™å…¥æ•°æ®çš„ç›®çš„åœ°çš„æŠ½è±¡ã€‚ä¸€ä¸ªä¾‹å­æ˜¯ fs.createWriteStream æ–¹æ³•ã€‚")]),t._v(" "),a("li",[t._v("åŒå·¥æµæ—¢å¯è¯»åˆå¯å†™ã€‚ TCP å¥—æ¥å­—å°±æ˜¯ä¸€ä¸ªä¾‹å­ã€‚")]),t._v(" "),a("li",[t._v("è½¬æ¢æµåŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªå¯ç”¨äºåœ¨å†™å…¥å’Œè¯»å–æ•°æ®æ—¶ä¿®æ”¹æˆ–è½¬æ¢æ•°æ®çš„åŒå·¥æµï¼Œä¸€ä¸ªä¾‹å­æ˜¯ zlib.createGzip æµä½¿ç”¨ gzip å‹ç¼©æ•°æ®ã€‚æ‚¨å¯ä»¥å°†è½¬æ¢æµè§†ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œå…¶ä¸­è¾“å…¥æ˜¯å¯å†™æµéƒ¨åˆ†ï¼Œè¾“å‡ºæ˜¯å¯è¯»æµéƒ¨åˆ†ã€‚æ‚¨å¯èƒ½è¿˜ä¼šå¬è¯´è¿‡è½¬æ¢æµè¢«ç§°ä¸ºâ€œ"),a("strong",[t._v("through streamsâ€œã€‚")])])]),t._v(" "),a("p",[t._v("æ‰€æœ‰æµéƒ½æ˜¯ EventEmitter ç±»çš„å®ä¾‹ã€‚å®ƒä»¬å¯ä»¥è§¦å‘ç›¸åº”çš„äº‹ä»¶ç”¨äºè¯»å–å’Œå†™å…¥æ•°æ®ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ pipe æ–¹æ³•ä»¥æ›´ç®€å•çš„æ–¹å¼ä½¿ç”¨æµæ•°æ®ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_4-pipe-æ–¹æ³•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-pipe-æ–¹æ³•"}},[t._v("#")]),t._v(" 4. "),a("strong",[t._v("pipe æ–¹æ³•")])]),t._v(" "),a("p",[t._v("ä¸‹é¢è¿™è¡Œç¥å¥‡çš„ä»£ç ä½ éœ€è¦è®°ä½å…ˆï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[t._v("readableSrc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("writableDest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("åœ¨è¿™ç®€å•çš„ä¸€è¡Œä»£ç ä¸­ï¼Œæˆ‘ä»¬æŠŠå¯è¯»æµçš„è¾“å‡ºç«¯é€šè¿‡ç®¡é“è¿æ¥åˆ°å¯å†™æµçš„è¾“å…¥ç«¯ã€‚è¾“å‡ºç«¯å¿…é¡»æ˜¯å¯è¯»æµï¼Œè¾“å…¥ç«¯å¿…é¡»æ˜¯å¯å†™æµã€‚å½“ç„¶ä¹Ÿå¯ä»¥è¿æ¥ä¸¤ä¸ªåŒå·¥/è½¬æ¢æµï¼Œå®é™…ä¸Šå¦‚æœç”¨ç®¡é“è¿æ¥åŒå·¥æµï¼Œpipæ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªè¾“å‡ºæµï¼Œå¯ä»¥ç”¨æ¥å®ç°é“¾å¼è°ƒç”¨ï¼Œå¯ä»¥å®ç°ç±»ä¼¼Linuxç®¡é“é‚£æ ·é“¾å¼è°ƒç”¨ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Which is equivalent to:")]),t._v("\na"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Which, in Linux, is equivalent to:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// $ a | b | c | d")]),t._v("\n")])])]),a("p",[t._v("pipe æ–¹æ³•æ˜¯æ¶ˆè´¹æµæœ€ç®€å•çš„æ–¹æ³•ã€‚é€šå¸¸å»ºè®®ä½¿ç”¨ç®¡é“æ–¹æ³•æˆ–ä½¿ç”¨äº‹ä»¶æ¶ˆè´¹æµï¼Œä¸è¦æ··ç€ç”¨ã€‚é€šå¸¸å½“ä½ ä½¿ç”¨ç®¡é“æ–¹æ³•æ—¶ï¼Œä½ ä¸éœ€è¦ä½¿ç”¨äº‹ä»¶ï¼Œä½†æ˜¯å¦‚æœä½ éœ€è¦ä»¥è‡ªå®šä¹‰çš„æ–¹å¼ä½¿ç”¨æµï¼Œäº‹ä»¶å°†æ˜¯æ‚¨çš„é€‰æ‹©ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_5-æµä¸­çš„äº‹ä»¶"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-æµä¸­çš„äº‹ä»¶"}},[t._v("#")]),t._v(" 5. æµ"),a("strong",[t._v("ä¸­çš„äº‹ä»¶")])]),t._v(" "),a("p",[t._v("é™¤äº†ä»å¯è¯»æµè¯»å–æ•°æ®å¹¶æ”¾åˆ°å¯å†™æµä¸­ï¼Œpipæ–¹æ³•è¿˜è‡ªåŠ¨å¸®æˆ‘ä»¬ç®¡ç†äº†å¾ˆå¤šäº‹ï¼Œä¾‹å¦‚é”™è¯¯å¤„ç†ã€æ–‡ä»¶å…³é—­ã€é€Ÿåº¦çš„è°ƒèŠ‚ã€‚")]),t._v(" "),a("p",[t._v("ç„¶è€Œï¼Œæµè¿˜å¯ä»¥é€šè¿‡äº‹ä»¶æœºåˆ¶æ¥æ§åˆ¶ï¼Œä¸‹é¢çš„ä»£ç æ˜¯ä½¿ç”¨äº‹ä»¶æœºåˆ¶å¯¹pipæ–¹æ³•çš„ç®€å•å®ç°ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// readable.pipe(writable)")]),t._v("\n\nreadable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"data"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("chunk")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  writable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nreadable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"end"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  writable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("ä¸‹é¢æ˜¯å¯è¯»å’Œå¯å†™æµä¸­çš„é‡è¦äº‹ä»¶å’Œæ–¹æ³•çš„åˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­çš„äº‹ä»¶å’Œæ–¹æ³•åœ¨æŸç§ç¨‹åº¦ä¸Šæ˜¯ç›¸å…³çš„ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸ä¸€èµ·ä½¿ç”¨ï¼š")]),t._v(" "),a("center",[a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/2022-1/nodestream6.png"}})]),t._v(" "),a("p",[a("strong",[t._v("å¯è¯»æµä¸Šæœ€é‡è¦çš„äº‹ä»¶ï¼š")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("data")]),t._v("äº‹ä»¶ï¼šæ¯å½“æµå°†å—æ•°æ®ä¼ é€’ç»™æ¶ˆè´¹è€…æ—¶å‘å‡º")]),t._v(" "),a("li",[a("code",[t._v("end")]),t._v("äº‹ä»¶ï¼šå½“æµä¸­æ•°æ®æ¶ˆè€—æ¶ˆè€—å®Œæ—¶å‘å‡º")])]),t._v(" "),a("p",[a("strong",[t._v("å¯å†™æµä¸Šæœ€é‡è¦çš„äº‹ä»¶ï¼š")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("drain")]),t._v("äº‹ä»¶ï¼šå¯å†™æµå·²è¢«â€æç©ºâ€œæ—¶è§¦å‘ï¼Œå¯ä»¥æ¥æ”¶æ•°æ®äº†")]),t._v(" "),a("li",[a("code",[t._v("finish")]),t._v("äº‹ä»¶ï¼šæ‰€æœ‰æ•°æ®éƒ½å·²è¢«å†™å…¥ç¡¬ä»¶æ—¶è§¦å‘")])]),t._v(" "),a("p",[t._v("äº‹ä»¶å’Œå‡½æ•°å¯ä»¥ç»“åˆèµ·æ¥ä½¿ç”¨ï¼Œç”¨äºå®šåˆ¶å’Œä¼˜åŒ–æµçš„ä½¿ç”¨ç»†èŠ‚ã€‚è‹¥è¦æ¶ˆè€—ä¸€ä¸ªå¯è¯»æµï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨"),a("code",[t._v("pip")]),t._v("æˆ–"),a("code",[t._v("unpip")]),t._v("æ–¹æ³•æˆ–"),a("code",[t._v("read")]),t._v("/"),a("code",[t._v("unshift")]),t._v("/"),a("code",[t._v("resume")]),t._v("æ–¹æ³•ã€‚è‹¥è¦ä½¿ç”¨ä¸€ä¸ªå¯å†™æµï¼Œæˆ‘ä»¬å¯ä»¥è®©å®ƒä½œä¸º"),a("code",[t._v("pip")]),t._v("æˆ–"),a("code",[t._v("unpip")]),t._v("æ–¹æ³•çš„æ¥æ”¶è€…ï¼Œæˆ–ä½¿ç”¨ "),a("code",[t._v("write")]),t._v(" æ–¹æ³•å†™å…¥å®ƒå¹¶åœ¨å®Œæˆåè°ƒç”¨ "),a("code",[t._v("end")]),t._v(" æ–¹æ³•ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_6-æµåŠ¨æ¨¡å¼å’Œæš‚åœæ¨¡å¼"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-æµåŠ¨æ¨¡å¼å’Œæš‚åœæ¨¡å¼"}},[t._v("#")]),t._v(" 6. æµåŠ¨æ¨¡å¼å’Œæš‚åœæ¨¡å¼")]),t._v(" "),a("p",[t._v("å¯è¯»æµæœ‰ä¸¤ç§ä¸»è¦æ¨¡å¼ï¼Œ"),a("strong",[t._v("æš‚åœæ¨¡å¼")]),t._v("å’Œ**æµåŠ¨æ¨¡å¼ï¼Œ**ä¸åŒæ¨¡å¼çš„ä½¿ç”¨æ–¹æ³•ä¸åŒã€‚è¿™ä¸¤ç§æ¨¡å¼è¿˜è¢«æˆä¸ºpullæ¨¡å¼å’Œpushæ¨¡å¼ã€‚")]),t._v(" "),a("p",[t._v("é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰å¯è¯»æµéƒ½ä»¥æš‚åœæ¨¡å¼å¯åŠ¨ï¼Œä½†å¯ä»¥åœ¨éœ€è¦æ—¶è½»æ¾åˆ‡æ¢åˆ°æµåŠ¨æ¨¡å¼æˆ–è¿”å›æš‚åœæ¨¡å¼ã€‚æœ‰æ—¶ï¼Œåˆ‡æ¢ä¼šè‡ªåŠ¨å‘ç”Ÿã€‚")]),t._v(" "),a("p",[t._v("å½“å¯è¯»æµå¤„äºæš‚åœæ¨¡å¼æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ read() æ–¹æ³•æŒ‰éœ€ä»æµä¸­è¯»å–ã€‚ä½†æ˜¯ï¼Œå¯¹äºæµåŠ¨æ¨¡å¼ä¸‹çš„å¯è¯»æµï¼Œæ•°æ®æ˜¯ä¸æ–­æµåŠ¨çš„ï¼Œæˆ‘ä»¬å¿…é¡»é€šè¿‡ç›‘å¬äº‹ä»¶æ¥æ¶ˆè´¹å®ƒã€‚")]),t._v(" "),a("p",[t._v("åœ¨æµåŠ¨æ¨¡å¼ä¸‹ï¼Œå¦‚æœæ²¡æœ‰å¯ç”¨çš„æ¶ˆè´¹è€…æ¥å¤„ç†æ•°æ®ï¼Œæ•°æ®å®é™…ä¸Šå¯èƒ½ä¼šä¸¢å¤±ã€‚å°±æ˜¯ä¸ºä»€ä¹ˆå½“æˆ‘ä»¬åœ¨æµåŠ¨æ¨¡å¼ä¸‹æœ‰ä¸€ä¸ªå¯è¯»æµæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ³¨å†Œdataäº‹ä»¶çš„å›è°ƒå‡½æ•°ã€‚è¿˜æœ‰ä¸€äº›dataäº‹ä»¶çš„æ³¨å†Œæ˜¯ä¸ºäº†å…¼å®¹æ—§çš„ Node æµæ¥å£ã€‚")]),t._v(" "),a("p",[t._v("è¦åœ¨è¿™ä¸¤ç§æµæ¨¡å¼ä¹‹é—´æ‰‹åŠ¨åˆ‡æ¢ï¼Œå¯ä»¥ä½¿ç”¨ "),a("code",[t._v("resume()")]),t._v(" å’Œ "),a("code",[t._v("pause()")]),t._v(" æ–¹æ³•ã€‚")]),t._v(" "),a("p",[t._v("ğŸ’¡ å½“ä½¿ç”¨ pipe æ–¹æ³•æ¶ˆè´¹å¯è¯»æµæ—¶ï¼Œæˆ‘ä»¬ä¸å¿…æ‹…å¿ƒè¿™äº›æ¨¡å¼ï¼Œå› ä¸º pipe ä¼šè‡ªåŠ¨ç®¡ç†å®ƒä»¬ã€‚")]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("â˜ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´ä»…åœ¨è°ˆè®ºæ¶ˆè´¹æµï¼Œè®©æˆ‘ä»¬å®ç°ä¸€äº›ï¼é€šå¸¸è¦å®ç°ä¸€ä¸ªæµï¼Œæ„å‘³ç€éœ€è¦å¯¼å…¥streamæ¨¡å—ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_7-å®ç°ä¸€ä¸ªå¯å†™æµ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-å®ç°ä¸€ä¸ªå¯å†™æµ"}},[t._v("#")]),t._v(" 7. å®ç°ä¸€ä¸ªå¯å†™æµ")]),t._v(" "),a("p",[t._v("è¦å®ç°å¯å†™æµï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨streamæ¨¡å—ä¸­çš„ Writable æ„é€ å‡½æ•°ï¼ˆç±»ï¼‰ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Writable "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stream"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("æˆ‘ä»¬å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å®ç°å¯å†™æµã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€è¦ç»§æ‰¿å¹¶æ‰©å±• Writable æ„é€ å‡½æ•°ï¼ˆç±»ï¼‰ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("myWritableStream")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Writable")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("ä½†æ˜¯ï¼Œæˆ‘æ›´å–œæ¬¢æ›´ç®€å•çš„æ–¹æ³•ã€‚æˆ‘ä»¬åªæ˜¯ä» Writable æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¼ é€’ç»™å®ƒä¸€äº›é€‰é¡¹ã€‚åªéœ€è¦å®ç°ä¸€ä¸ª write å‡½æ•°ï¼Œè¿™ä¸ªwriteæ–¹æ³•å®šä¹‰è¦å†™å…¥çš„æ•°æ®å—ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Writable "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stream"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" outStream "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Writable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" encoding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nprocess"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stdin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("outStream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("è¿™ä¸ª write æ–¹æ³•æ¥å—ä¸‰ä¸ªå‚æ•°ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("chunkï¼šé€šå¸¸æ˜¯ä¸€ä¸ªbuffer")]),t._v(" "),a("li",[t._v("encodingï¼šå¯ä»¥å¿½ç•¥ï¼Œæœ‰é»˜è®¤å€¼")]),t._v(" "),a("li",[t._v("callbackï¼šå¤„ç†å®Œæ•°æ®å—åå¿…é¡»è¦è°ƒç”¨çš„å‡½æ•°ï¼Œè¿™æ˜¯å†™å…¥æ˜¯å¦æˆåŠŸçš„ä¿¡å·ï¼Œå¦‚æœå‘è¡¨æ˜å¤±è´¥åˆ™å¯ä»¥ä¼ å…¥ä¸€ä¸ªerrorå¯¹è±¡ã€‚")])]),t._v(" "),a("p",[t._v("åœ¨ä¸Šé¢çš„outStreamä¸­ï¼Œæˆ‘ä»¬åªç®€å•çš„æ‰“å°äº†chunkçš„å­—ç¬¦ä¸²å½¢å¼ï¼Œç„¶ååœ¨æ²¡æœ‰é”™è¯¯çš„æƒ…å†µä¸‹è°ƒç”¨callbackä»¥æŒ‡ç¤ºæˆåŠŸã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•ä¸”çœ‹èµ·æ¥æ²¡ä»€ä¹ˆç”¨çš„â€å›å£°â€œæµï¼Œå®ƒä¼šè¿”å›ä»»ä½•æ¥æ”¶åˆ°çš„å†…å®¹ã€‚è¦ä½¿ç”¨è¿™ä¸ªæµï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°å°†å®ƒä¸ process.stdinï¼ˆå¯è¯»æµï¼‰ ä¸€èµ·ä½¿ç”¨ï¼Œç›´æ¥pipè¿æ¥å³å¯ã€‚")]),t._v(" "),a("p",[t._v("å½“æˆ‘ä»¬è¿è¡Œä¸Šé¢çš„ä»£ç æ—¶ï¼Œæˆ‘ä»¬åœ¨ process.stdin ä¸­è¾“å…¥çš„ä»»ä½•å†…å®¹éƒ½å°†ä½¿ç”¨è¢«æ‰“å°å‡ºæ¥ã€‚")]),t._v(" "),a("p",[t._v("è¿™ä¸ªå¯å†™æµæ˜¯ä¸€ä¸ªæ²¡ä»€ä¹ˆç”¨çš„å®ç°ï¼Œå› ä¸ºå®ƒå®é™…ä¸Šå·²ç»å®ç°å¹¶å†…ç½®äº†ï¼Œå…¶åŠŸèƒ½ç±»ä¼¼ process.stdoutï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[t._v("process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stdin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stdout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"_8-å®ç°ä¸€ä¸ªå¯è¯»æµ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-å®ç°ä¸€ä¸ªå¯è¯»æµ"}},[t._v("#")]),t._v(" 8. å®ç°ä¸€ä¸ªå¯è¯»æµ")]),t._v(" "),a("p",[t._v("æœ‰ä¸€ç§å®ç°å¯è¯»æµçš„ç®€å•æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥pushå¸Œæœ›æ¶ˆè´¹è€…å¾—åˆ°çš„æ•°æ®ã€‚")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Readable "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stream"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" inStream "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Readable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\ninStream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ABCDEFGHIJKLM"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ninStream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NOPQRSTUVWXYZ"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\ninStream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// No more data")]),t._v("\n\ninStream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stdout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("å½“æˆ‘ä»¬pushä¸€ä¸ªnullæ—¶ï¼Œè¡¨æ˜æµä¸­æ²¡æœ‰æ•°æ®è¦å†™å…¥äº†ã€‚")]),t._v(" "),a("p",[t._v("å½“æˆ‘ä»¬è¿è¡Œä¸Šé¢çš„ä»£ç æ—¶ï¼Œæˆ‘ä»¬å°†ä» inStream è¯»å–æ‰€æœ‰æ•°æ®å¹¶å°†å…¶å›æ˜¾åˆ°æ ‡å‡†è¾“å‡ºã€‚éå¸¸ç®€å•ï¼Œä½†ä¹Ÿä¸æ˜¯å¾ˆé«˜æ•ˆã€‚")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬åŸºæœ¬ä¸Šæ˜¯å…ˆå°†æ‰€æœ‰æ•°æ®æ¨é€åˆ°æµï¼Œç„¶åæ‰è¿æ¥åˆ°æ ‡å‡†è¾“å‡ºæµï¼Œæ›´å¥½çš„æ–¹æ³•æ˜¯å½“æ¶ˆè´¹è€…è¯·æ±‚æ—¶æŒ‰éœ€æ¨é€ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨å¯è¯»æµé…ç½®ä¸­å®ç° read() æ–¹æ³•æ¥åšåˆ°è¿™ä¸€ç‚¹")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" inStream "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Readable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("read")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// there is a demand on the data...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Someone wants to read it.")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("å½“åœ¨å¯è¯»æµä¸Šè°ƒç”¨ read æ–¹æ³•æ—¶ï¼Œå®ƒå¯ä»¥å°†éƒ¨åˆ†æ•°æ®æ¨é€åˆ°é˜Ÿåˆ—ä¸­ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€æ¬¡æ¨é€ä¸€ä¸ªå­—æ¯ï¼Œä»å­—ç¬¦ä»£ç  65ï¼ˆä»£è¡¨ Aï¼‰å¼€å§‹ï¼Œå¹¶åœ¨æ¯æ¬¡æ¨é€æ—¶é€’å¢ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" inStream "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Readable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("read")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("String"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fromCharCode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("currentCharCode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("currentCharCode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("90")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\ninStream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("currentCharCode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("65")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\ninStream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stdout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("å½“æ¶ˆè´¹è€…è¯»å–å¯è¯»æµæ—¶ï¼Œread æ–¹æ³•å°†è¿ç»­è§¦å‘ï¼Œpushæ›´å¤šå­—æ¯åˆ°æµä¸­ï¼Œæˆ‘ä»¬ä¹Ÿç¼–å†™äº†åœæ­¢pushçš„æ¡ä»¶ï¼Œpushåˆ°zååœæ­¢ã€‚")]),t._v(" "),a("p",[t._v("è¿™æ®µä»£ç çš„åŠŸèƒ½å’Œæˆ‘ä»¬æœ€å¼€å§‹çš„é‚£æ®µä»£ç ç›¸åŒï¼Œä½†ç°åœ¨æˆ‘ä»¬æ˜¯æŒ‰éœ€æ¨é€æ•°æ®ã€‚ä½ åº”è¯¥æ€»æ˜¯è¿™æ ·åšã€‚")]),t._v(" "),a("h2",{attrs:{id:"_9-å®ç°åŒå·¥-è½¬æ¢æµ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-å®ç°åŒå·¥-è½¬æ¢æµ"}},[t._v("#")]),t._v(" 9. å®ç°åŒå·¥/è½¬æ¢æµ")]),t._v(" "),a("p",[t._v("å®ç°ä¸€ä¸ªåŒå·¥æµæ„å‘³ç€åŒæ—¶å®ç°å¯è¯»æµå’Œå¯å†™æµï¼Œç›¸å½“äºåŒæ—¶ç»§æ‰¿äº†ä¸¤ä¸ªç±»ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªåŒå·¥æµçš„ç¤ºä¾‹ï¼Œå®ƒç»“åˆäº†ä¸Šé¢å®ç°çš„ä¸¤ä¸ªå¯å†™å’Œå¯è¯»æµï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Duplex "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stream"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" inoutStream "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Duplex")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" encoding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("read")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("String"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fromCharCode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("currentCharCode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("currentCharCode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("90")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\ninoutStream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("currentCharCode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("65")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nprocess"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stdin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("inoutStream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stdout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("è¦çŸ¥é“åŒå·¥æµçš„å¯è¯»å’Œå¯å†™ä¾§å®Œå…¨ç‹¬ç«‹äºå½¼æ­¤è¿è¡Œè¿™ç‚¹å¾ˆé‡è¦ï¼Œè¿™åªæ˜¯å°†ä¸¤ä¸ªç‰¹å¾ç»„åˆæˆä¸€ä¸ªå¯¹è±¡è€Œå·²ã€‚")]),t._v(" "),a("p",[t._v("è½¬æ¢æµæ˜¯æ›´æœ‰è¶£çš„åŒå·¥æµï¼Œå› ä¸ºå®ƒçš„è¾“å‡ºæ˜¯æ ¹æ®å…¶è¾“å…¥è®¡ç®—çš„ã€‚")]),t._v(" "),a("p",[t._v("å¯¹äºè½¬æ¢æµï¼Œæˆ‘ä»¬ä¸å¿…å®ç° read æˆ– write æ–¹æ³•ï¼Œæˆ‘ä»¬åªéœ€è¦å®ç°ä¸€ä¸ªtransformæ–¹æ³•ï¼Œå®ƒå…·æœ‰ write æ–¹æ³•çš„ç­¾åï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨transformæ–¹æ³•è¿›è¡Œpushæ“ä½œï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Transform "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stream"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" upperCaseTr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Transform")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("transform")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" encoding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toUpperCase")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nprocess"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stdin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("upperCaseTr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stdout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("åœ¨è¿™ä¸ªè½¬æ¢æµä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„è½¬æ¢æµä¸å‰é¢çš„åŒå·¥æµç¤ºä¾‹å®Œå…¨ä¸€æ ·ï¼Œæˆ‘ä»¬åªå®ç°äº†ä¸€ä¸ª transform() æ–¹æ³•ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_10-æµå¯¹è±¡æ¨¡å¼"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-æµå¯¹è±¡æ¨¡å¼"}},[t._v("#")]),t._v(" 10. æµå¯¹è±¡æ¨¡å¼")]),t._v(" "),a("p",[t._v("é»˜è®¤æƒ…å†µä¸‹ï¼ŒæµæœŸå¾…æ¥æ”¶ Buffer/String ç±»å‹çš„å€¼ã€‚æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ª objectMode æ ‡å¿—ï¼Œè®©æµæ¥å—ä»»ä½• JavaScript å¯¹è±¡ã€‚")]),t._v(" "),a("p",[t._v("ä¸‹é¢ç”¨ä¸€ä¸ªç®€å•ç¤ºä¾‹æ¥è¯´æ˜è¿™ä¸€ç‚¹ï¼Œä»¥ä¸‹è½¬æ¢æµçš„ç»„åˆå®ç°äº†ä¸€ä¸ªåŠŸèƒ½ï¼šå°†ä¸€ä¸²é€—å·åˆ†éš”å€¼æ˜ å°„åˆ° JavaScript å¯¹è±¡ã€‚"),a("code",[t._v('"a,b,c,d"')]),t._v("è½¬æ¢ä¸ºÂ "),a("code",[t._v("{a: b, c: d}")]),t._v("ã€‚")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Transform "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stream"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" commaSplitter "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Transform")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("readableObjectMode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("transform")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" encoding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      chunk\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("trim")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("split")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('","')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" arrayToObject "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Transform")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("readableObjectMode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("writableObjectMode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("transform")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" encoding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" obj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" objectToString "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Transform")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("writableObjectMode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("transform")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" encoding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//-----------------------")]),t._v("\nprocess"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stdin\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("commaSplitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("arrayToObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("objectToString"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stdout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("center",[a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/2022-1/nodestream7.png"}})]),t._v(" "),a("h2",{attrs:{id:"_11-ä¸€äº›å†…ç½®çš„è½¬æ¢æµç¤ºä¾‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-ä¸€äº›å†…ç½®çš„è½¬æ¢æµç¤ºä¾‹"}},[t._v("#")]),t._v(" 11. ä¸€äº›å†…ç½®çš„è½¬æ¢æµç¤ºä¾‹")]),t._v(" "),a("p",[t._v("Node æœ‰ä¸€äº›éå¸¸æœ‰ç”¨çš„å†…ç½®è½¬æ¢æµï¼Œä¾‹å¦‚ zlibã€crypto æµã€‚")]),t._v(" "),a("p",[t._v("ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ zlib.createGzip() æµç»“åˆ fs å¯è¯»/å¯å†™æµæ¥åˆ›å»ºä¸€ä¸ªç”¨äºæ–‡ä»¶å‹ç¼©çš„ç¤ºä¾‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" zlib "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zlib"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" file "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("argv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nfs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createReadStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("zlib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createGzip")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createWriteStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('".gz"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("å¯ä»¥ä½¿ç”¨æ­¤è„šæœ¬å¯¹ä»»ä½•æ–‡ä»¶è¿›è¡Œ gzip å‹ç¼©ã€‚æˆ‘ä»¬å°†è¯¥æ–‡ä»¶çš„å¯è¯»æµä¼ è¾“åˆ° zlib å†…ç½®è½¬æ¢æµä¸­ï¼Œç„¶åå†ä¼ è¾“åˆ°æ–° gzip å‹ç¼©æ–‡ä»¶çš„å¯å†™æµä¸­ï¼Œå¾ˆç®€å•ã€‚")]),t._v(" "),a("p",[t._v("ä½¿ç”¨pipeå¾ˆé…·çš„ä¸€ç‚¹æ˜¯ï¼Œå¦‚æœéœ€è¦ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬ä¸äº‹ä»¶ç»“åˆèµ·æ¥ã€‚ä¾‹å¦‚ï¼Œæˆ‘å¸Œæœ›ç”¨æˆ·åœ¨è„šæœ¬è¿è¡Œæ—¶çœ‹åˆ°è¿›åº¦æŒ‡ç¤ºå™¨ï¼Œå¹¶åœ¨è„šæœ¬å®Œæˆæ—¶çœ‹åˆ°â€œå®Œæˆâ€æ¶ˆæ¯ã€‚ç”±äºpipeæ–¹æ³•è¿”å›ç›®æ ‡æµï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é“¾æ¥ä¸€ä¸ªäº‹ä»¶çš„æ³¨å†Œï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" zlib "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zlib"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" file "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("argv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nfs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createReadStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("zlib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createGzip")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"data"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stdout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createWriteStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('".zz"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"finish"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Done"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("ä½¿ç”¨ pipe æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°ä½¿ç”¨æµï¼Œä½†æˆ‘ä»¬ä»ç„¶å¯ä»¥åœ¨éœ€è¦æ—¶ä½¿ç”¨äº‹ä»¶è¿›ä¸€æ­¥è‡ªå®šä¹‰ä¸è¿™äº›æµçš„äº¤äº’è¿‡ç¨‹ã€‚")]),t._v(" "),a("p",[t._v("ç®¡é“æ–¹æ³•çš„ä¼˜ç‚¹åœ¨äºæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒä»¥ä¸€ç§æ›´æ˜“è¯»çš„æ–¹å¼ç»„åˆæˆ‘ä»¬çš„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œç›¸æ¯”ç›‘å¬æ•°æ®çš„äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªè½¬æ¢æµæ¥æŠ¥å‘Šè¿›åº¦å¹¶å°† .on() è°ƒç”¨æ›¿æ¢ä¸ºå¦ä¸€ä¸ª .pipe() è°ƒç”¨ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" zlib "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zlib"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" file "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("argv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Transform "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stream"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" reportProgress "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Transform")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("transform")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" encoding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stdout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nfs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createReadStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("zlib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createGzip")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reportProgress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createWriteStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('".zz"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"finish"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Done"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("è¿™ä¸ª reportProgress æµæ˜¯ä¸€ä¸ªç®€å•çš„ä¼ é€’æµï¼Œä½†å®ƒä¹Ÿå°†è¿›åº¦æŠ¥å‘Šåˆ°æ ‡å‡†è¾“å‡ºï¼Œè¯·æ³¨æ„æˆ‘å¦‚ä½•ä½¿ç”¨ callback() å‡½æ•°ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°å°†æ•°æ®æ¨é€åˆ° transform() æ–¹æ³•ä¸­ï¼Œè¿™å’Œç›´æ¥pushçš„æ•ˆæœä¸€æ ·ã€‚")]),t._v(" "),a("p",[t._v("ç»„åˆæµçš„åº”ç”¨æ˜¯æ— ç©·æ— å°½çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦åœ¨ gzip ä¹‹å‰æˆ–ä¹‹ååŠ å¯†æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯æŒ‰ç…§æˆ‘ä»¬éœ€è¦çš„ç¡®åˆ‡é¡ºåºç®¡é“å¦ä¸€ä¸ªè½¬æ¢æµï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæ­¤ä½¿ç”¨ Node çš„cryptoæ¨¡å—ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" crypto "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"crypto"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ..")]),t._v("\n\nfs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createReadStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("zlib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createGzip")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("crypto"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createCipher")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"aes192"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a_secret"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reportProgress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createWriteStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('".zz"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"finish"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Done"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("ä¸Šé¢çš„è„šæœ¬æŠŠæ¥æ”¶çš„æ–‡ä»¶å‹ç¼©ç„¶ååŠ å¯†ã€‚åªæœ‰çŸ¥é“å¯†é’¥çš„äººæ‰èƒ½ä½¿ç”¨è¾“å‡ºçš„æ–‡ä»¶ã€‚æˆ‘ä»¬ä¸èƒ½ç”¨æ™®é€šçš„è§£å‹å·¥å…·è§£å‹è¿™ä¸ªæ–‡ä»¶ï¼Œå› ä¸ºå®ƒæ˜¯åŠ å¯†çš„ã€‚")]),t._v(" "),a("p",[t._v("ä¸ºäº†çœŸæ­£èƒ½å¤Ÿè§£å‹ç¼©ä½¿ç”¨ä¸Šè¿°è„šæœ¬å‹ç¼©çš„ä»»ä½•å†…å®¹ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ç›¸åçš„é¡ºåºå¯¹ crypto å’Œ zlib ä½¿ç”¨ç›¸åçš„æµï¼Œè¿™å¾ˆç®€å•ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[t._v("fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createReadStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("crypto"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createDecipher")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"aes192"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a_secret"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("zlib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createGunzip")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reportProgress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createWriteStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("slice")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"finish"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Done"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("å‡è®¾ä½¿ç”¨çš„æ–‡ä»¶æ˜¯å‹ç¼©ç‰ˆæœ¬ï¼Œä¸Šé¢çš„ä»£ç å°†åˆ›å»ºä¸€ä¸ªå¯è¯»æµæµï¼Œå°†å…¶é€šè¿‡ç®¡é“ä¼ è¾“åˆ°åŠ å¯† createDecipher() æµä¸­ï¼ˆä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼‰ï¼Œå°†å…¶è¾“å‡ºé€šè¿‡ç®¡é“ä¼ è¾“åˆ° zlib createGunzip() æµä¸­ï¼Œç„¶åå°†å†…å®¹å†™å›æ²¡æœ‰æ‰©å±•éƒ¨åˆ†çš„æ–‡ä»¶ã€‚")]),t._v(" "),a("p",[t._v("ğŸ‰ ğŸ’¯")]),t._v(" "),a("h2",{attrs:{id:"å‚è€ƒæ–‡æ¡£"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒæ–‡æ¡£"}},[t._v("#")]),t._v(" å‚è€ƒæ–‡æ¡£")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://jscomplete.com/learn/node-beyond-basics/node-streams",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nodeâ€™s Streams"),a("OutboundLink")],1)])])],1)}),[],!1,null,null,null);s.default=p.exports}}]);